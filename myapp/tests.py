import pandas as pd
from .models import DataStatic, DataTS

"""
# copy from the excel file data to be pasted in the code
df = pd.read_clipboard()
df_new = df[['ISIN', 'Index_Symbol', 'Instrument_Name', 'Weight', 'Date',
       'Close_unadjusted_local']]
# run the following and dopy the code output to df2

df_new.to_dict('records')

"""

df2 = pd.DataFrame([{'ISIN': 'CH0038863350',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'NESTLE N',
  'Weight': 16.28359,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 94.78},
 {'ISIN': 'CH0012005267',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'NOVARTIS N',
  'Weight': 11.63816,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 88.24},
 {'ISIN': 'CH0012032048',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'ROCHE GS',
  'Weight': 10.16709,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 224.9},
 {'ISIN': 'CH0244767585',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'UBS GROUP N',
  'Weight': 5.93927,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 28.56},
 {'ISIN': 'CH0210483332',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'RICHEMONT N',
  'Weight': 4.76495,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 137.75},
 {'ISIN': 'CH0011075394',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'ZURICH INSURANCE N',
  'Weight': 4.51094,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 479.0},
 {'ISIN': 'CH0012221716',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'ABB LTD N',
  'Weight': 4.40336,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 42.33},
 {'ISIN': 'CH0012214059',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'HOLCIM N',
  'Weight': 2.8068,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 80.48},
 {'ISIN': 'CH0418792922',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SIKA N',
  'Weight': 2.77672,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 268.9},
 {'ISIN': 'CH0013841017',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'LONZA N',
  'Weight': 2.63164,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 549.2},
 {'ISIN': 'CH0432492467',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'ALCON N',
  'Weight': 2.44947,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 76.18},
 {'ISIN': 'CH0126881561',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SWISS RE N',
  'Weight': 2.06399,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 110.45},
 {'ISIN': 'CH0010645932',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'GIVAUDAN N',
  'Weight': 2.02467,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 3956.0},
 {'ISIN': 'CH0024608827',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'PARTNERS GROUP N',
  'Weight': 1.85915,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 1274.0},
 {'ISIN': 'CH0014852781',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SWISS LIFE HOLDING AG N',
  'Weight': 1.18216,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 622.4},
 {'ISIN': 'CH0030170408',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'GEBERIT N',
  'Weight': 1.12587,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 523.4},
 {'ISIN': 'CH1175448666',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'STRAUMANN N',
  'Weight': 1.02025,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 140.15},
 {'ISIN': 'CH0025238863',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'KUEHNE+NAGEL INT N',
  'Weight': 0.92445,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 258.7},
 {'ISIN': 'CH0008742519',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SWISSCOM N',
  'Weight': 0.86326,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 528.0},
 {'ISIN': 'CH0025751329',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'LOGITECH N',
  'Weight': 0.85251,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 80.64},
 {'ISIN': 'CH0311864901',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'VAT GROUP N',
  'Weight': 0.82368,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 475.9},
 {'ISIN': 'CH1256740924',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SGS N',
  'Weight': 0.8208,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 84.16},
 {'ISIN': 'CH0012549785',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SONOVA N',
  'Weight': 0.80933,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 255.5},
 {'ISIN': 'CH0010570759',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'LINDT N',
  'Weight': 0.76099,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 103800.0},
 {'ISIN': 'CH1243598427',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SANDOZ GROUP N',
  'Weight': 0.72384,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 26.1},
 {'ISIN': 'CH0102484968',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'JULIUS BAER N',
  'Weight': 0.70651,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 53.3},
 {'ISIN': 'CH0010570767',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'LINDT PS',
  'Weight': 0.68021,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 10380.0},
 {'ISIN': 'CH0024638196',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SCHINDLER PS',
  'Weight': 0.59002,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 225.2},
 {'ISIN': 'CH0435377954',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SIG Group N',
  'Weight': 0.44927,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 20.16},
 {'ISIN': 'CH0012032113',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'ROCHE I',
  'Weight': 0.44775,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 237.6},
 {'ISIN': 'CH0008038389',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SWISS PRIME SITE N',
  'Weight': 0.42158,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 85.4},
 {'ISIN': 'CH0012410517',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'BALOISE N',
  'Weight': 0.40699,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 138.1},
 {'ISIN': 'CH0012255151',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SWATCH GROUP I',
  'Weight': 0.3964,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 212.9},
 {'ISIN': 'CH0012138605',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'ADECCO N',
  'Weight': 0.3739,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 34.5},
 {'ISIN': 'CH0018294154',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'PSP N',
  'Weight': 0.35299,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 119.6},
 {'ISIN': 'CH1169151003',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'GEORG FISCHER N',
  'Weight': 0.32811,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 65.45},
 {'ISIN': 'CH0016440353',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'EMS-CHEMIE N',
  'Weight': 0.31117,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 711.0},
 {'ISIN': 'CH0024638212',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'SCHINDLER N',
  'Weight': 0.29594,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 218.5},
 {'ISIN': 'CH0012100191',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'TECAN GROUP AG N',
  'Weight': 0.29365,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 357.0},
 {'ISIN': 'CH0009002962',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'BARRY CALLEBAUT N',
  'Weight': 0.28382,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 1238.0},
 {'ISIN': 'CH0466642201',
  'Index_Symbol': 'SXGE',
  'Instrument_Name': 'HELVETIA HOLDING N',
  'Weight': 0.27886,
  'Date': '2024-04-04',
  'Close_unadjusted_local': 124.0}])


# Iterate over the rows of the dataframe
for index, row in df2.iterrows():

    print('Adding row:', row)
    # Get the reporter and the company

    data_static, _ = DataStatic.objects.get_or_create(
        isin=row['ISIN'],
        name=row['Instrument_Name']
    )

    data_ts, _ = DataTS.objects.get_or_create(
        data_static=data_static,
        index_symbol=row['Index_Symbol'],
        weight=row['Weight'],
        date=row['Date'],
        price=row['Close_unadjusted_local'],
    )

    data_static.save()
    data_ts.save()


